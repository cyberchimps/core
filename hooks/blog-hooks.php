<?php
/**
 * Title: Blog Hooks
 *
 * Description: Defines actions/hooks for blog page.
 *
 * Please do not edit this file. This file is part of the Cyber Chimps Framework and all modifications
 * should be made in a child theme.
 *
 * @category Cyber Chimps Framework
 * @package  Framework
 * @since    1.0
 * @author   CyberChimps
 * @license  http://www.opensource.org/licenses/gpl-license.php GPL v2.0 (or later)
 * @link     http://www.cyberchimps.com/
 */

function cyberchimps_blog_section_order_action() {
	global $post;
	
	$defaults = array();
	$default = apply_filters( 'cyberchimps_elements_draganddrop_defaults', array(
																																								'slider_lite'		 => __( 'Slider Lite', 'cyberchimps' ),
																																								'boxes_lite'				 => __( 'Boxes', 'cyberchimps' ),
																																								'blog_post_page' => __( 'Post Page', 'cyberchimps' )
																																							) );
	foreach( $default as $key => $val ) {
		$defaults[] = $key;
	}
	
	$blog_section_order = cyberchimps_get_option( 'blog_section_order', $defaults );
	//select default in case options are empty
	$blog_section_order = ( $blog_section_order == '' ) ? array( 'blog_post_page' ) : $blog_section_order;
	$slider_size = cyberchimps_get_option( 'blog_slider_size', 'full' );
	if ( is_array($blog_section_order) ) {
		foreach ( $blog_section_order as $func) {
			// checks if slider is selected at half size, if it is it removes it so we can display it above blog content
			if( $func == 'page_slider' && cyberchimps_get_option( 'blog_slider_size' ) == 'half' ) {
				$func = '';
			}
			do_action($func);
		}
	}
}
add_action('cyberchimps_blog_content', 'cyberchimps_blog_section_order_action');

function cyberchimps_post(){ ?>
<div id="container" <?php cyberchimps_filter_container_class(); ?>>

	<?php do_action( 'cyberchimps_before_content_container'); ?>
  
	<div id="content" <?php cyberchimps_filter_content_class(); ?>>
		
		<?php do_action( 'cyberchimps_before_content'); ?>
		
		<?php if ( have_posts() ) : ?>
			
			<?php while ( have_posts() ) : the_post(); ?>

				<?php get_template_part( 'content', get_post_format() ); ?>
				
			<?php endwhile; ?>
			
		<?php elseif ( current_user_can( 'edit_posts' ) ) : ?>

			<?php get_template_part( 'no-results', 'index' ); ?>

		<?php endif; ?>
		
		<?php do_action( 'cyberchimps_after_content'); ?>
		
	</div><!-- #content -->
<?php do_action( 'cyberchimps_after_content_container'); ?>
	
</div><!-- #container -->
<?php }
add_action( 'blog_post_page', 'cyberchimps_post' );